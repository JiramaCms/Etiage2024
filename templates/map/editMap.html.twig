{# templates/map.html.twig #}
{% extends 'base.html.twig' %}

{% block body %}
    <div class="container">
        <h1>My Leaflet Map</h1>
        <div id="mapid" style="height: 600px;"></div>
    </div>


    <script>
        // Initialiser la carte
        var mymap = L.map('mapid').setView([-18.917923, 47.522342], 13);

        // Ajouter une couche de tuiles (tiles layer)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(mymap);


         //Affichage
        // Ajouter un marqueur (marker)
        {% for point in allPoints %}
        L.marker([{{ point.latitude}}, {{point.longitude}}]).addTo(mymap)
            .bindPopup('{{point.nom}}')
            .closePopup();
        {% endfor %}

        L.circle([-18.919095, 47.525500], {
            color: 'red',
            fillColor: '#f03',
            fillOpacity: 0.5,
            radius: 200
        }).addTo(mymap)
            .bindPopup('cette zone est demilitaris√©')
            .closePopup()

        var popup = L.popup();
        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("You clicked the map at " + e.latlng.toString())
                .openOn(mymap);
        }

        mymap.on('click', onMapClick);
    </script>
{% endblock %}